C51 COMPILER V9.00   MAIN                                                                  06/05/2014 10:05:02 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Output\main.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c LARGE OPTIMIZE(9,SPEED) BROWSE DEFINE(RELEASE) DEBUG OBJECTEXTEND PR
                    -INT(.\Output\main.lst) OBJECT(.\Output\main.obj)

line level    source

   1          #include "EO3000I_API.h"
   2          #include "EO3000I_CFG.h"
   3          
   4          #define  RM_CODE_ADDR1 0x7E00
   5          #define  RM_CODE_ADDR2 0x7D00
   6          #define  ID_NUM_ADDR   0x7C00
   7          
   8          #define TURE  1
   9          #define FALSE 0
  10          
  11          uint32 ID_ADDR[10]={0x7B00,0x7A00,0x7900,0x7800,0x7700,0x7600,0x7500,0x7400,0x7300,0x7200};
  12          
  13          code uint8 VERSION_APP[] = {0xE0,'V','E','R','S','I','O','N',1,0,4,0,'A','R','A','D','I','O','T','O','S','
             -E','R','I','A','L',0x00,0xE0};
  14          
  15          uint8   key_learn_num=1;  //if user push the Learn button,key_learn_num++ .
  16          uint8   control_line=0;
  17          uint8   learn_mode=0;
  18          uint8   Switch_AB=0;
  19          
  20          uint8   A_IO_num=0;    // num of the PTM200(can control line_A)
  21          uint8   B_IO_num=0;    // num of the PTM200(can control line_B)
  22          
  23          
  24          
  25          struct Switch_PTM200{   //define the PTM200's ID & 4 Buttons
  26                  uint32 Switch_ID;       
  27                  uint8  Button_AI;       //0x10
  28                  uint8  Button_AO;       //0x30
  29                  uint8  Button_BI;       //0x50
  30                  uint8  Button_BO;       //0x70   Turn on:0    Turn off:1     undefine:3
  31          };
  32          
  33          struct Switch_PTM200 Line_A[30]={0,3,3,3,3};   //init the line A
  34          
  35          struct Switch_PTM200 Line_B[30]={0,3,3,3,3};   //init the line B
  36          
  37          typedef struct
  38          {
  39                  // Public 
  40                  uint8           u8Pin;                  // e.g. ADIO0
  41                  uint8           u8ActiveState;  // button is pressed if (io_getDigital(u8Button)==bActiveState)
  42                  uint16          u16TimeOutON;   // time [ms] the button has to be pressed to be recognized as pressed
  43                  uint16          u16TimeOutOFF;  // time [ms] the button has to be pressed to be recognized as released  
  44                  // Private
  45                  TIMER_TYPE      tTimer;
  46                  uint8           u8State;
  47          } BTN_STRUCT;
  48          
  49          typedef enum 
  50          {
  51                  BTN_IDLE = 0,
  52                  BTN_EDGE1,
  53                  BTN_TRIGGERED,
C51 COMPILER V9.00   MAIN                                                                  06/05/2014 10:05:02 PAGE 2   

  54                  BTN_PRESSED,    //< most important
  55                  BTN_PRESS_HOLD,
  56                  BTN_EDGE2,
  57                  BTN_RELEASE_HOLD,
  58                  BTN_RELEASED    
  59          } BTN_STATE;
  60          
  61          BTN_STATE btn_getState(BTN_STRUCT *pBtn)
  62          {
  63   1              code uint8 transition_table[8][4]={     0,      1,      0,      1,
  64   1                                                                                      5,      2,      5,      1,
  65   1                                                                                      5,      2,      5,      3,
  66   1                                                                                      5,      4,      5,      4,
  67   1                                                                                      5,      4,      5,      4,
  68   1                                                                                      6,      1,      0,      1,
  69   1                                                                                      6,      1,      7,      1,
  70   1                                                                                      0,      1,      0,      1 };    
  71   1              register uint8 u8Input; 
  72   1              // Get button state
  73   1              io_getDigital(pBtn->u8Pin, &u8Input);
  74   1              u8Input = (u8Input == pBtn->u8ActiveState)?1:0; 
  75   1              // Get timeout state
  76   1              u8Input |= ((time_getTimeOut(&(pBtn->tTimer))==TIME_OUT)?2:0);
  77   1              // Get new state
  78   1              pBtn->u8State = transition_table[pBtn->u8State][u8Input]; // we want only the state, not action
  79   1              // Perform action 
  80   1              switch (pBtn->u8State)
  81   1              {
  82   2                      case 1:
  83   2                              time_setTimerCount(&(pBtn->tTimer), pBtn->u16TimeOutON);
  84   2                              break;
  85   2                      case 5:
  86   2                              time_setTimerCount(&(pBtn->tTimer), pBtn->u16TimeOutOFF);
  87   2                              break;
  88   2              }
  89   1              return pBtn->u8State;   
  90   1      }
  91          
  92          BTN_STATE btn_getState(BTN_STRUCT *pBtn);
  93          
  94          
  95          // Define Learn button (KEY1 push 250ms)
  96          BTN_STRUCT btnLearn = {WSDADIO_2,               // Pin
  97                                                          0,                          // Active state
  98                                                          250,                // Time the button has to be in 'Active state' to be recognized as pressed
  99                                                          100 };  
 100          
 101          // Define Quit button  (KEY2 push 200ms)
 102          BTN_STRUCT btnQuit = {RSDADIO_3,                // Pin
 103                                                          0,                          // Active state
 104                                                          200,                // Time the button has to be in 'Active state' to be recognized as pressed
 105                                                          100 };
 106          
 107          // Define Clean button (KEY2 push 3s)
 108          BTN_STRUCT btnClean = {RSDADIO_3,               // Pin
 109                                                          0,                          // Active state
 110                                                          3000,               // Time the button has to be in 'Active state' to be recognized as pressed
 111                                                          100 };
 112          
 113          
 114          void blinkledA(int led_1)
 115          {
C51 COMPILER V9.00   MAIN                                                                  06/05/2014 10:05:02 PAGE 3   

 116   1                      io_setDigital(SCLKDIO_1,1);
 117   1                      time_wait(100);
 118   1                      io_setDigital(SCLKDIO_1,0);
 119   1                      time_wait(100);
 120   1                      io_setDigital(SCLKDIO_1,1);
 121   1                      time_wait(100);
 122   1                      io_setDigital(SCLKDIO_1,0);
 123   1                      time_wait(100);
 124   1                      io_setDigital(SCLKDIO_1,led_1);
 125   1      }
 126          
 127          void blinkledB(int led_2)
 128          {
 129   1                      io_setDigital(SCSEDIO_0,1);
 130   1                      time_wait(100);
 131   1                      io_setDigital(SCSEDIO_0,0);
 132   1                      time_wait(100);
 133   1                      io_setDigital(SCSEDIO_0,1);
 134   1                      time_wait(100);
 135   1                      io_setDigital(SCSEDIO_0,0);
 136   1                      time_wait(100);
 137   1                      io_setDigital(SCSEDIO_0,led_2);
 138   1      }
 139          
 140          
 141          void testled(int jj)
 142          {
 143   1          int num=0;
 144   1              for(num=0;num<jj;num++)
 145   1              {
 146   2                      io_setDigital(SCLKDIO_1,0);
 147   2                      io_setDigital(SCSEDIO_0,0);
 148   2                      time_wait(200);
 149   2                      io_setDigital(SCLKDIO_1,1);
 150   2                      io_setDigital(SCSEDIO_0,1);
 151   2                      time_wait(200);
 152   2              }
 153   1      }
 154          
 155          
 156          
 157          void Write_info_flash()
 158          {
 159   1      
 160   1      
 161   1      }
 162          
 163          
 164          
 165          void Mode_Control()
 166          {
 167   1              if (btn_getState(&btnLearn)==BTN_PRESSED)
 168   1                      {       
 169   2                              if(key_learn_num==1)              //push learn button once£¬ligth the LED1 
 170   2                              {
 171   3                                      io_setDigital(SCLKDIO_1,1);       //control LED
 172   3                                      io_setDigital(SCSEDIO_0,0);
 173   3                                      learn_mode=1;                 //start the learn mode
 174   3                                      control_line=1;                           //choice the control line     1
 175   3                              }
 176   2      
 177   2                              if(key_learn_num==2)              //push learn button once again£¬light the LED2 
C51 COMPILER V9.00   MAIN                                                                  06/05/2014 10:05:02 PAGE 4   

 178   2                              {
 179   3                                      io_setDigital(SCLKDIO_1,0);
 180   3                                      io_setDigital(SCSEDIO_0,1);
 181   3                                      learn_mode=1;
 182   3                                      control_line=2;                           //choice the control line     2
 183   3                              }
 184   2                              
 185   2                              if(key_learn_num==3)             //push learn button once again£¬light the LED1 & LED2 
 186   2                              {
 187   3                                      io_setDigital(SCLKDIO_1,1);
 188   3                                      io_setDigital(SCSEDIO_0,1);
 189   3                                      learn_mode=1;                            //choice the control line      1 & 2
 190   3                                      control_line=3;
 191   3                              }
 192   2              
 193   2                              key_learn_num++;
 194   2                              if(key_learn_num>3)                  //  loop LED1 & LED2
 195   2                              {
 196   3                                      key_learn_num=1;
 197   3                              }
 198   2                      }
 199   1                                      
 200   1              if (btn_getState(&btnQuit)==BTN_PRESSED)  //push the EXIT button for more than 200ms
 201   1              {
 202   2                      io_setDigital(SCLKDIO_1,0);
 203   2                      io_setDigital(SCSEDIO_0,0);
 204   2                      learn_mode=0;     //exit the learn mode
 205   2                      key_learn_num=1;
 206   2                      control_line=1;                           //choice the control line 1
 207   2                      blinkledB(0);
 208   2              }
 209   1              
 210   1              if (btn_getState(&btnClean)==BTN_PRESSED)  //push the clear button for more than 3s
 211   1              {
 212   2                      learn_mode=0;     //exit the learn mode
 213   2                      key_learn_num=1;
 214   2                      control_line=1;                           //choice the control line
 215   2                      blinkledB(0);
 216   2                      //do the clear work
 217   2      
 218   2                      Write_info_flash();
 219   2                      //write into flash
 220   2      
 221   2      
 222   2              }                                       
 223   1      }
 224          
 225          
 226          void Learn_mode_function()
 227          {
 228   1              uint8   A_find_new_PTM200=1;
 229   1              uint8   B_find_new_PTM200=1;
 230   1              if(learn_mode==1)
 231   1              {
 232   2                  uint8   i=0;           // used for searching the ID
 233   2                      struct myRadioType{ 
 234   2                      CHOICE_TYPE u8Choice; 
 235   2                      uint8  Data; 
 236   2                      uint32 u32Id; 
 237   2                      uint8  u8Status; 
 238   2                      uint8  u8Chk; 
 239   2                              uint8  u8Fill[RADIO_BUFF_LENGTH-8];     // align u8Length as last byte in structure !!!
C51 COMPILER V9.00   MAIN                                                                  06/05/2014 10:05:02 PAGE 5   

 240   2                      RADIO_TEL_LENGTH u8Length; 
 241   2                      }learn_RT1;
 242   2                      TEL_PARAM_TYPE  pTelIn1;         //init a input radio
 243   2                      
 244   2                      if (radio_getTelegram((TEL_RADIO_TYPE *)&learn_RT1, &pTelIn1) == OK)  //if get a radio
 245   2                      {
 246   3                              switch(control_line)     
 247   3                              {
 248   4                              case 1:{   //choose line 1(A)
 249   5                                                 for(i=0;i<15;i++)
 250   5                                                 {
 251   6                                                              if(Line_A[i].Switch_ID==learn_RT1.u32Id)   //this PTM200 has been learned.
 252   6                                                              {
 253   7                                                                      if(learn_RT1.Data==0x10||learn_RT1.Data==0x30)
 254   7                                                                      {
 255   8                                                                              Line_A[i].Button_AI=1;     //ligth off
 256   8                                                                      Line_A[i].Button_AO=0;     //light on
 257   8                                                                              blinkledA(1);
 258   8                                                                              break;
 259   8                                                                      }
 260   7                                                                      else if(learn_RT1.Data==0x50||learn_RT1.Data==0x70)
 261   7                                                                      {
 262   8                                                                              Line_A[i].Button_BI=1;
 263   8                                                                      Line_A[i].Button_BO=0;
 264   8                                                                              blinkledA(1);
 265   8                                                                              break;
 266   8                                                                      }
 267   7                                                                      else
 268   7                                                                      {
 269   8                                                                              break;
 270   8                                                                      }
 271   7                                                                      A_find_new_PTM200=0;
 272   7                                                                      break;                                                          
 273   7                                                              }
 274   6      
 275   6                                                 }                               
 276   5                                                 if(A_find_new_PTM200==1)   //if this PTM200 is newer.
 277   5                                                 {
 278   6                                                              if(learn_RT1.Data==0x10||learn_RT1.Data==0x30)   //push button AI or AO
 279   6                                                              {
 280   7                                                                      Line_A[A_IO_num].Switch_ID=learn_RT1.u32Id;
 281   7                                                                      Line_A[A_IO_num].Button_AI=1;      //ligth off
 282   7                                                                      Line_A[A_IO_num].Button_AO=0;      //light on                                    
 283   7                                                                      blinkledA(1);                                                           
 284   7                                                              }
 285   6                                                              else if(learn_RT1.Data==0x50||learn_RT1.Data==0x70)
 286   6                                                              {
 287   7                                                                      Line_A[A_IO_num].Switch_ID=learn_RT1.u32Id;
 288   7                                                                      Line_A[A_IO_num].Button_BI=1;
 289   7                                                                      Line_A[A_IO_num].Button_BO=0;                                    
 290   7                                                                      blinkledA(1);                                                                                                   
 291   7                                                          }
 292   6                                                              else         // learn_RT1.Data==0x00 or else
 293   6                                                              {
 294   7                                                                      break;   //exit the switch    
 295   7                                                              }
 296   6                                                              if(A_IO_num==30)    //max num (PTM200 can learn) is 30
 297   6                                                              {
 298   7                                                                      A_IO_num=0;   
 299   7                                                              }
 300   6                                                              else if(A_IO_num>=0&&A_IO_num<15)
 301   6                                                              {
C51 COMPILER V9.00   MAIN                                                                  06/05/2014 10:05:02 PAGE 6   

 302   7                                                                      A_IO_num++;        //next key(in PTM200
 303   7                                                              }
 304   6                                                              break;
 305   6                                                 }                                                                                                                                                                                                            
 306   5      
 307   5                                         };
 308   4      /*************************************************************************************************/
 309   4                              case 2:{        //choose line 2(B)                                              
 310   5                                                 for(i=0;i<15;i++)
 311   5                                                 {
 312   6                                                              if(Line_B[i].Switch_ID==learn_RT1.u32Id)   //this PTM200 has been learned.
 313   6                                                              {
 314   7                                                                      if(learn_RT1.Data==0x10||learn_RT1.Data==0x30)
 315   7                                                                      {
 316   8                                                                              Line_B[i].Button_AI=1;     //ligth off
 317   8                                                                      Line_B[i].Button_AO=0;     //light on
 318   8                                                                              blinkledB(1);
 319   8                                                                              break;
 320   8                                                                      }
 321   7                                                                      else if(learn_RT1.Data==0x50||learn_RT1.Data==0x70)
 322   7                                                                      {
 323   8                                                                              Line_B[i].Button_BI=1;
 324   8                                                                      Line_B[i].Button_BO=0;
 325   8                                                                              blinkledB(1);
 326   8                                                                              break;
 327   8                                                                      }
 328   7                                                                      B_find_new_PTM200=0;
 329   7                                                                      break;                                                          
 330   7                                                              }
 331   6                                                 }
 332   5                                                      if(B_find_new_PTM200==1)   //if this PTM200 is newer.
 333   5                                                      {
 334   6                                      if(learn_RT1.Data==0x10||learn_RT1.Data==0x30)   //push button AI or AO
 335   6                                                              {
 336   7                                                                       Line_B[B_IO_num].Switch_ID=learn_RT1.u32Id;
 337   7                                                                       Line_B[B_IO_num].Button_AI=1;     //ligth off
 338   7                                                                       Line_B[B_IO_num].Button_AO=0;     //light on                                    
 339   7                                                                       blinkledB(1);                                                          
 340   7                                                              }                               
 341   6                                                              else if(learn_RT1.Data==0x50||learn_RT1.Data==0x70)   //push button AI or AO
 342   6                                                              {
 343   7                                                                      Line_B[B_IO_num].Switch_ID=learn_RT1.u32Id;             
 344   7                                                                      Line_B[B_IO_num].Button_BI=1;      //ligth off
 345   7                                                                      Line_B[B_IO_num].Button_BO=0;      //light on                                    
 346   7                                                                      blinkledB(1);
 347   7                                                              }
 348   6                                                              else
 349   6                                                              {
 350   7                                                                      break;
 351   7                                                              }                                               
 352   6                                                              if(B_IO_num==30)    //loop
 353   6                                                              {
 354   7                                                                      B_IO_num=0;   
 355   7                                                              }
 356   6                                                              else if(B_IO_num>=0&&B_IO_num<15)
 357   6                                                              {
 358   7                                                                      B_IO_num++;        //next key(in PTM200)
 359   7                                                              }
 360   6                                                              break;                                          
 361   6                                                      }
 362   5                                                                                                                                              
 363   5                                         };
C51 COMPILER V9.00   MAIN                                                                  06/05/2014 10:05:02 PAGE 7   

 364   4      
 365   4      /*************************************************************************************************/                              
 366   4                          case 3:{    //choose line 1 & line 2 (A&B)
 367   5                                                      if(learn_RT1.Data==0x10||learn_RT1.Data==0x30)   //push button AI or AO
 368   5                                                      {
 369   6                                                               Line_A[A_IO_num].Switch_ID=learn_RT1.u32Id;
 370   6                                                               Line_A[A_IO_num].Button_AI=1;     //ligth off
 371   6                                                               Line_A[A_IO_num].Button_AO=0;     //light on
 372   6                                                               Line_B[B_IO_num].Switch_ID=learn_RT1.u32Id;
 373   6                                                               Line_B[B_IO_num].Button_AI=1;     //ligth off
 374   6                                                               Line_B[B_IO_num].Button_AO=0;     //light on                                    
 375   6                                                               blinkledA(1);                                                          
 376   6                                                      }                               
 377   5                                                      if(learn_RT1.Data==0x50||learn_RT1.Data==0x70)   //push button AI or AO
 378   5                                                      {
 379   6                                                              Line_A[A_IO_num].Switch_ID=learn_RT1.u32Id;      // line A
 380   6                                                              Line_A[A_IO_num].Button_BI=1;
 381   6                                                              Line_A[A_IO_num].Button_BO=0;
 382   6                                                              Line_B[B_IO_num].Switch_ID=learn_RT1.u32Id;      // line B              
 383   6                                                              Line_B[B_IO_num].Button_BI=1;      
 384   6                                                              Line_B[B_IO_num].Button_BO=0;                                            
 385   6                                                              blinkledA(1);
 386   6                                                      }
 387   5                                                      
 388   5                                                      if(A_IO_num==30)    //loop
 389   5                                                      {
 390   6                                                              A_IO_num=0;   
 391   6                                                      }
 392   5                                                      else
 393   5                                                      {
 394   6                                                              A_IO_num++;        //next key(in PTM200)
 395   6                                                      }
 396   5                                                      
 397   5                                                      if(B_IO_num==30)    //loop
 398   5                                                      {
 399   6                                                              B_IO_num=0;   
 400   6                                                      }
 401   5                                                      else
 402   5                                                      {
 403   6                                                              B_IO_num++;        //next key(in PTM200)
 404   6                                                      }                       
 405   5                                     };
 406   4      
 407   4                          default:break;
 408   4                              //end
 409   4                          }
 410   3                              
 411   3                      }
 412   2              }
 413   1      }
 414          
 415          
 416          void Work_function()
 417          {
 418   1              if(learn_mode==0)
 419   1              {
 420   2                      uint8   j=0;           // used for searching the ID 
 421   2                      struct myRadioType{ 
 422   2                              CHOICE_TYPE u8Choice; 
 423   2                              uint8  Data; 
 424   2                              uint32 u32Id; 
 425   2                              uint8  u8Status; 
C51 COMPILER V9.00   MAIN                                                                  06/05/2014 10:05:02 PAGE 8   

 426   2                              uint8  u8Chk; 
 427   2                                      uint8  u8Fill[RADIO_BUFF_LENGTH-8];     // align u8Length as last byte in structure !!!
 428   2                              RADIO_TEL_LENGTH u8Length; 
 429   2                              }learn_RT2;
 430   2                      TEL_PARAM_TYPE  pTelIn2;         //init a input radio
 431   2              
 432   2                      if (radio_getTelegram((TEL_RADIO_TYPE *)&learn_RT2, &pTelIn2) == OK)  //if get a radio
 433   2                              {
 434   3                                      for(j=0;j<15;j++)
 435   3                                      {
 436   4                                              if(learn_RT2.u32Id==Line_A[j].Switch_ID)
 437   4                                              {                                                                               
 438   5                                                      if(learn_RT2.Data==0x10)       //button:  AI
 439   5                                                      {
 440   6                                                              if(Line_A[j].Button_AI==1) //line A
 441   6                                                              {
 442   7                                                                      //turn off the light A
 443   7                                                                      blinkledA(0);
 444   7                                                                      break;                                                  
 445   7                                                              }
 446   6                                                              else if(Line_A[j].Button_AI==3)
 447   6                                                              {
 448   7                                                                      break;
 449   7                                                              }
 450   6                                                              else
 451   6                                                              {
 452   7                                                                      break;
 453   7                                                              }               
 454   6                                                      }       
 455   5                                                      else if(learn_RT2.Data==0x30) //button:  AO
 456   5                                                      {
 457   6                                                              if(Line_A[j].Button_AO==0)
 458   6                                                              {
 459   7                                                                      //turn on the light 
 460   7                                                                      blinkledA(1);
 461   7                                                                      break;                                                  
 462   7                                                              }
 463   6                                                              else if(Line_A[j].Button_AO==3)
 464   6                                                              {
 465   7                                                                      break;
 466   7                                                              }
 467   6                                                              else
 468   6                                                              {
 469   7                                                                      break;
 470   7                                                              }                                       
 471   6                                                      }
 472   5                                                      else if(learn_RT2.Data==0x50) //button:  BI
 473   5                                                      {
 474   6                                                              if(Line_A[j].Button_BI==1)
 475   6                                                              {
 476   7                                                                      //turn off the light
 477   7                                                                      blinkledA(0);
 478   7                                                                      break;                                                          
 479   7                                                              }
 480   6                                                              else if(Line_A[j].Button_BI==3)
 481   6                                                              {
 482   7                                                                      break;
 483   7                                                              }
 484   6                                                              else
 485   6                                                              {
 486   7                                                                      break;
 487   7                                                              }                                       
C51 COMPILER V9.00   MAIN                                                                  06/05/2014 10:05:02 PAGE 9   

 488   6                                                      }
 489   5                                                      else if(learn_RT2.Data==0x70) //button:  BO
 490   5                                                      {
 491   6                                                              if(Line_A[j].Button_BO==0)
 492   6                                                              {
 493   7                                                                      //turn on the light 
 494   7                                                                      blinkledA(1);
 495   7                                                                      break;
 496   7                                                              }
 497   6                                                              else if(Line_A[j].Button_BO==3)
 498   6                                                              {
 499   7                                                                      break;
 500   7                                                              }
 501   6                                                              else
 502   6                                                              {
 503   7                                                                      break;
 504   7                                                              }                                       
 505   6                                                      }
 506   5                                                      else  //radio's data is wrong(radio's data list:0x10  0x30  0x50  0x70)
 507   5                                                      {
 508   6                                                              break;
 509   6                                                      }                                       
 510   5                                              }  //end of line_A
 511   4                                      } //end of search ID
 512   3      /*******************************************************************************/
 513   3                                      for(j=0;j<15;j++)    //search line B
 514   3                                      {
 515   4                                              if(learn_RT2.u32Id==Line_B[j].Switch_ID)
 516   4                                              {                                                                               
 517   5                                                      if(learn_RT2.Data==0x10)       //button:  AI
 518   5                                                      {
 519   6                                                              if(Line_B[j].Button_AI==1) //line B
 520   6                                                              {
 521   7                                                                      //turn off the light A
 522   7                                                                      blinkledB(0);
 523   7                                                                      break;                                                  
 524   7                                                              }
 525   6                                                              else if(Line_B[j].Button_AI==3)
 526   6                                                              {
 527   7                                                                      break;
 528   7                                                              }
 529   6                                                              else
 530   6                                                              {
 531   7                                                                      break;
 532   7                                                              }               
 533   6                                                      }       
 534   5                                                      else if(learn_RT2.Data==0x30) //button:  AO
 535   5                                                      {
 536   6                                                              if(Line_B[j].Button_AO==0)
 537   6                                                              {
 538   7                                                                      //turn on the light 
 539   7                                                                      blinkledB(1);
 540   7                                                                      break;                                                  
 541   7                                                              }
 542   6                                                              else if(Line_B[j].Button_AO==3)
 543   6                                                              {
 544   7                                                                      break;
 545   7                                                              }
 546   6                                                              else
 547   6                                                              {
 548   7                                                                      break;
 549   7                                                              }                                       
C51 COMPILER V9.00   MAIN                                                                  06/05/2014 10:05:02 PAGE 10  

 550   6                                                      }
 551   5                                                      else if(learn_RT2.Data==0x50) //button:  BI
 552   5                                                      {
 553   6                                                              if(Line_B[j].Button_BI==1)
 554   6                                                              {
 555   7                                                                      //turn off the light
 556   7                                                                      blinkledB(0);
 557   7                                                                      break;                                                          
 558   7                                                              }
 559   6                                                              else if(Line_B[j].Button_BI==3)
 560   6                                                              {
 561   7                                                                      break;
 562   7                                                              }
 563   6                                                              else
 564   6                                                              {
 565   7                                                                      break;
 566   7                                                              }                                       
 567   6                                                      }
 568   5                                                      else if(learn_RT2.Data==0x70) //button:  BO
 569   5                                                      {
 570   6                                                              if(Line_B[j].Button_BO==0)
 571   6                                                              {
 572   7                                                                      //turn on the light 
 573   7                                                                      blinkledB(1);
 574   7                                                                      break;
 575   7                                                              }
 576   6                                                              else if(Line_B[j].Button_BO==3)
 577   6                                                              {
 578   7                                                                      break;
 579   7                                                              }
 580   6                                                              else
 581   6                                                              {
 582   7                                                                      break;
 583   7                                                              }                                       
 584   6                                                      }
 585   5                                                      else  //radio's data is wrong(radio's data list:0x10  0x30  0x50  0x70)
 586   5                                                      {
 587   6                                                              break;
 588   6                                                      }                                               
 589   5                                              }  //end of line_B
 590   4                                      } //end of search ID
 591   3      
 592   3      
 593   3      
 594   3                              }
 595   2              }
 596   1      }
 597          
 598          
 599          void main()
 600          {               
 601   1              mainInit();
 602   1      
 603   1              radio_enableRx(1);
 604   1      
 605   1              while (1)
 606   1              {            
 607   2                      CLR_WDT();                            //Clear the watchdog.
 608   2                                                                                      
 609   2                      Mode_Control();            //choose work mode,while user push the button.
 610   2      
 611   2                      Learn_mode_function();    //in the learn mode,learn the PTM200's info.
C51 COMPILER V9.00   MAIN                                                                  06/05/2014 10:05:02 PAGE 11  

 612   2      
 613   2                      Work_function();          //push the button on the PTM200,control the light.
 614   2      
 615   2              }
 616   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1917    ----
   CONSTANT SIZE    =     60    ----
   XDATA SIZE       =    574      72
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
